(function(a){a(document).ready(function(){var f={fontset:"",modules:[],branding:{}};var h=false;var m=/["'\\]/g;var e=false;var k={init:function(){a(".branding-bg-color").wpColorPicker(b);a("#semplice").on("click",".content-container a, .mc-content-container a, .mc-sub-content-container a",function(t){t.preventDefault()});var r=function(u){u=u||window.event;var t="Do you really want to close the page without saving your progress?";if(u){u.returnValue=t}return t};window.onbeforeunload=r;if(a(".semplice-content").val()){a(".loader").show();var s=a.ajax({url:ajaxurl,type:"POST",data:{action:"semplice_ce_ajax",edit_mode:"init",post_id:wordpress.post_id},dataType:"json"});s.done(function(t){f=a.parseJSON(t.rom);var u=a(".fontset").val();if(f.branding===undefined){f.branding={}}if(f.modules===undefined){f.modules=[]}a("#semplice-content").css({"background-color":f.branding["background-color"],"background-image":"url("+f.branding["background-image"]+")","background-size":f.branding["background-size"],"background-position":f.branding["background-position"],"background-repeat":f.branding["background-repeat"],"background-attachment":f.branding["background-attachment"]});if(f.branding["background-image"]){a(".branding-bg-image-preview").attr("src",f.branding["background-image"]).show();a("input[name=branding-bg-image]").val(f.branding["background-image"])}a("#semplice-content").children("#content-holder").remove();a("#semplice-content").append(t.html);if(!a.trim(a("#semplice-content #content-holder").html()).length){a(".semplice-ce-default").clone(true).appendTo("#semplice-content").stop().fadeIn(500)}a(".is-masonry").each(function(){var v=a(this).attr("id");if(v!==undefined){a("#"+v).masonry()}});a(".image-link").click(function(v){return false});if(u!=="default"){a(".custom-fontset").find("option").each(function(){if(a(this).val()===u){a(this).attr("selected","selected")}else{a(this).removeAttr("selected")}});k.customFontset(u)}else{k.customFontset("default")}a(".save-to-wp").addClass("save-to-wp-activated");a(".loader").fadeOut("slow")});s.fail(function(t,u){alert("JSON Parse Error: "+u);a(".loader").fadeOut("slow")});s.error(function(t){alert(t.responseText)})}else{k.customFontset("default");a("#semplice-content").html("");a("#semplice-content").append('<div id="content-holder"></div>');a(".semplice-ce-default").clone(true).appendTo("#semplice-content").stop().fadeIn(500);a(".save-to-wp").addClass("save-to-wp-activated")}},add:function(x){a(".loader").show();if(a("#semplice-content").find(a(".semplice-ce-default")).is(":visible")){a("#semplice-content").find(a(".semplice-ce-default")).remove()}var r=l("content");var w="#"+r;var s=a(x).data("content-type");var v={"background-color":"transparent","background-image":"","background-size":"none","background-position":"50% 0%","background-repeat":"no-repeat","padding-top":"0px","padding-bottom":"0px","padding-right":"0px","padding-left":"0px"};if(s==="multi-column"){f[w]={columns:{},styles:{}}}else{f[w]={styles:{}}}var t=a(x).data("module-id");if(t){f[w]["custom_module"]=t;a(".modules-sub").fadeOut("fast")}f[w].styles=v;var u=a.ajax({url:ajaxurl,type:"POST",data:{action:"semplice_ce_ajax",id:r,content_type:s,edit_mode:"new",rom:f[w]},dataType:"html"});u.done(function(y){if(y==="ModuleNotFound"){alert("Module not found! Please make sure the selected module is installed.");a(".loader").fadeOut("slow")}else{a("#content-holder").append(y);a(w).find(".color-picker").wpColorPicker(q);a(w).find(".wp-picker-default").remove();a(w).find(".padding-left, .padding-right").remove();if(s==="multi-column"){a(w).find(".save").attr("class","save-mc");a(w).find(".duplicate").attr("class","duplicate-mc");a(w).find(".save-block").attr("class","save-block-mc");o()}a(w).addClass("in-edit-mode");a(w).find(".fadein").transition({opacity:1},500,"ease",function(){a(this).removeClass("fadein")});a(".loader").fadeOut("slow");a(a.browser.webkit?"body":"html").animate({scrollTop:a(w).offset().top-100},0)}});u.fail(function(y,z){alert("Request failed: "+z);a(".loader").fadeOut("slow")})},addColumn:function(w){a(".loader").show();var v="#"+a(w).data("content-id");var u=a(v).find(".column").length+1;var r=l("column");var t="#"+r;var s=a.ajax({url:ajaxurl,type:"POST",data:{action:"semplice_ce_ajax",id:r,parent_id:v,column_count:u,content_type:"add-column",edit_mode:"new"},dataType:"html"});s.done(function(x){a(v).find(".columns").append(x);a(t).find(".save").remove();a(t).find(".fadein").transition({opacity:1},500,"ease",function(){a(this).removeClass("fadein")});a(".loader").fadeOut("slow");a("#semplice").on("click",".add-column",g);a(a.browser.webkit?"body":"html").animate({scrollTop:a(t).offset().top-100},0)});s.fail(function(x,y){alert("Request failed: "+y);a(".loader").fadeOut("slow")})},addColumnContent:function(w){a(".loader").show();var z="#"+(w).data("content-id");var t=l("column_content");var r="#"+(w).data("column-id");var s="#"+t;var x=a(w).data("content-type");var y={"background-color":"transparent","background-image":"","background-size":"none","background-position":"50% 0%","background-repeat":"no-repeat","padding-top":"0px","padding-bottom":"0px","padding-right":"0px","padding-left":"0px"};if(f[z].columns[r]===undefined){f[z].columns[r]={}}f[z].columns[r][s]={styles:{}};f[z].columns[r][s].styles=y;var v=a(w).data("module-id");if(v){f[z].columns[r][s]["custom_module"]=v;a(".modules-sub").fadeOut("fast")}var u=a.ajax({url:ajaxurl,type:"POST",data:{action:"semplice_ce_ajax",id:t,ccId:z,content_type:x,rom:f[z],column_id:r,edit_mode:"new",is_column_content:true},dataType:"html"});u.done(function(A){if(A==="ModuleNotFound"){alert("Module not found! Please make sure the selected module is installed.");a(".loader").fadeOut("slow")}else{a(r).find(".column-inner").append(A);if(v){a(s).attr("data-module-id",v)}a(s).find(".save").remove();a(s).prev(".placeholder").remove();a(s).find(".color-picker").wpColorPicker(q);a(s).find(".wp-picker-default").remove();a(s).addClass("in-edit-mode");a(s).find(".fadein").transition({opacity:1},500,"ease",function(){a(this).removeClass("fadein")});a(".loader").fadeOut("slow");a(a.browser.webkit?"body":"html").animate({scrollTop:a(s).offset().top-140},0)}});u.fail(function(A,B){alert("Request failed: "+B);a(".loader").fadeOut("slow")})},save:function(y,w,v){a(".loader").show();var s=a(y).data("content-id");var x="#"+a(y).data("content-id");var t=a(y).data("content-type");var r;e=false;f[x]={content:"",styles:{},options:{},custom_module:"",content_type:t};a(x).find(".is-content").each(function(){f[x].content=a(this).val();if(a(this).val().length===0){r=true}});a(x).find(".is-option").each(function(){if(a.isArray(a(this).val())){f[x].options[a(this).attr("name")]=a(this).val()}else{if(!a(this).val().match(m)){f[x].options[a(this).attr("name")]=a(this).val()}else{e=true;c(a(this).attr("name"))}}});a(x).find(".is-style").each(function(){if(!a(this).val().match(m)){f[x].styles[a(this).attr("name")]=a(this).val()}else{e=true;c(a(this).attr("name"))}});a(x).find(".is-custom-module").each(function(){f[x].custom_module=a(this).val().replace(/["']/g,"")});f[x].styles["background-color"]=j(f[x].styles["background-color"]);if(!r&&!e){var u=a.ajax({url:ajaxurl,type:"POST",data:{action:"semplice_ce_ajax",id:s,content_type:t,rom:f[x],post_id:wordpress.post_id},dataType:"html"});u.done(function(z){a(x).append(z);a("#semplice").on("click",".save",{duplicate:false,save_block:false},p);a("#semplice").on("click",".duplicate",{duplicate:true,save_block:false},p);a("#semplice").on("click",".save-block",{duplicate:false,save_block:true},p);a(x).find(".edit-content").remove();a(x).removeClass("in-edit-mode");a(x).find(".fadein-view").transition({opacity:1},500,"ease",function(){a(this).removeClass("fadein-view")});a(".loader").fadeOut("slow");a(a.browser.webkit?"body":"html").animate({scrollTop:a(x).offset().top-100},0);if(w){k.duplicate(y)}else{if(v){k.saveBlock(y)}}});u.fail(function(z,A){alert("Request failed: "+A);a("#semplice").on("click",".save",p);a(".loader").fadeOut("slow")})}else{if(!e){alert("Please add some content before save!")}a("#semplice").on("click",".save",{duplicate:false,save_block:false},p);a("#semplice").on("click",".duplicate",{duplicate:true,save_block:false},p);a("#semplice").on("click",".save-block",{duplicate:false,save_block:true},p);a(".loader").fadeOut("slow")}},saveSingleEdit:function(u){a(".loader").show();var z="#"+a(u).data("container-id");var y=a(u).data("container-id");var x=a(u).data("content-id");var s="#"+a(u).data("content-id");var r=a(u).data("column-id");var v=a(u).data("content-type");var w;e=false;a(s).find(".is-content").each(function(){f[z].columns[r][s].content=a(this).val();if(a(this).val().length===0){w=true}});a(s).find(".is-cc-option").each(function(){if(!a(this).val().match(m)){f[z].columns[r][s].options[a(this).attr("name")]=a(this).val()}else{e=true;c(a(this).attr("name"))}});a(s).find(".is-cc-style").each(function(){if(!a(this).val().match(m)){f[z].columns[r][s].styles[a(this).attr("name")]=a(this).val()}else{e=true;c(a(this).attr("name"))}});f[z].columns[r][s].styles["background-color"]=j(f[z].columns[r][s].styles["background-color"]);if(!w&&!e){var t=a.ajax({url:ajaxurl,type:"POST",data:{action:"semplice_ce_ajax",id:y,rom:f[z],content_type:"multi-column",post_id:wordpress.post_id},dataType:"html"});t.done(function(A){a(z).find(s).remove();a(z).append(A);a("#semplice").on("click",".save-se",d);a(z).removeClass("in-edit-mode");a(z).find(".fadein-view").transition({opacity:1},500,"ease",function(){a(this).removeClass("fadein-view")});a(".loader").fadeOut("slow");a(a.browser.webkit?"body":"html").animate({scrollTop:a(z).offset().top-100},0)});t.fail(function(A,B){alert("Request failed: "+B);a("#semplice").on("click",".save-se",d);a(".loader").fadeOut("slow")})}else{if(!e){alert("Please add some content before save!")}a("#semplice").on("click",".save-se",d);a(".loader").fadeOut("slow")}},saveColumnContent:function(y,w,v){a(".loader").show();var s=a(y).data("content-id");var x="#"+a(y).data("content-id");var r;e=false;var t=a(y).data("content-type");f[x]={columns:{},styles:{},options:{},content_type:t};a(x).find(".is-option").each(function(){if(!a(this).val().match(m)){f[x].options[a(this).attr("name")]=a(this).val()}else{e=true;c(a(this).attr("name"))}});a(x).find(".is-style").each(function(){if(!a(this).val().match(m)){f[x].styles[a(this).attr("name")]=a(this).val()}else{e=true;c(a(this).attr("name"))}});f[x].styles["background-color"]=j(f[x].styles["background-color"]);a(x).find(".column").each(function(){var z="#"+a(this).attr("id");f[x].columns[z]={options:{}};a(a(this)).find(".is-option").each(function(){f[x].columns[z].options[a(this).attr("name")]=a(this).val()});a(this).find(".column-content").each(function(){var D=a(this);var C="#"+a(this).data("content-id");var B="#"+a(this).data("in-column");var A=a(this).data("content-type");f[x].columns[B][C]={content:{},styles:{},options:{},custom_module:"",content_type:A};a(this).find(".is-content").each(function(){f[x].columns[B][C].content=a(this).val();if(a(this).val().length===0){r=true}});a(this).find(".is-cc-option").each(function(){if(!a(this).val().match(m)){f[x].columns[B][C].options[a(this).attr("name")]=a(this).val()}else{e=true;c(a(this).attr("name"))}});a(this).find(".is-cc-style").each(function(){if(!a(this).val().match(m)){f[x].columns[B][C].styles[a(this).attr("name")]=a(this).val()}else{e=true;c(a(this).attr("name"))}});a(this).find(".is-cc-custom-module").each(function(){f[x].columns[B][C].custom_module=a(this).val().replace(/["']/g,"")});f[x].columns[B][C].styles["background-color"]=j(f[x].columns[B][C].styles["background-color"])})});if(a(x).find(".column").length!==0&&a(x).find(".column-content").length!==0&&!r&&!e){var u=a.ajax({url:ajaxurl,type:"POST",data:{action:"semplice_ce_ajax",id:s,rom:f[x],content_type:t,post_id:wordpress.post_id},dataType:"html"});u.done(function(z){a(x).append(z);a("#semplice").on("click",".save-mc",{duplicate:false,save_block:false},i);a("#semplice").on("click",".duplicate-mc",{duplicate:true,save_block:false},i);a("#semplice").on("click",".save-block-mc",{duplicate:false,save_block:true},i);a(x).find(".edit-content").remove();a(x).removeClass("in-edit-mode");a(x).find(".fadein-view").transition({opacity:1},500,"ease",function(){a(this).removeClass("fadein-view")});a(".loader").fadeOut("slow");a(a.browser.webkit?"body":"html").animate({scrollTop:a(x).offset().top-100},0);if(w){k.duplicate(y)}else{if(v){k.saveBlock(y)}}});u.fail(function(z,A){alert("Request failed: "+A);a("#semplice").on("click",".save-mc",{duplicate:false,save_block:false},i);a("#semplice").on("click",".duplicate-mc",{duplicate:true,save_block:false},i);a("#semplice").on("click",".save-block-mc",{duplicate:false,save_block:true},i);a(".loader").fadeOut("slow")})}else{if(!e){alert("Please add a column and a column content before save.")}a("#semplice").on("click",".save-mc",{duplicate:false},i);a("#semplice").on("click",".duplicate-mc",{duplicate:true},i);a(".loader").fadeOut("slow")}},edit:function(v){a(".loader").show();o();var r=a(v).data("content-id");var u="#"+a(v).data("content-id");var s=a(v).data("content-type");var t=a.ajax({url:ajaxurl,type:"POST",data:{action:"semplice_ce_ajax",edit_mode:"edit",id:r,content_type:s,rom:f[u]},dataType:"html"});t.done(function(w){if(w==="ModuleNotFound"){alert("Module not found! Please re-install the module used in this content.");a("#semplice").on("click",".content-container",n);a(".loader").fadeOut("slow")}else{a(u).append(w);if(s==="multi-column"){a(u).find(".mc-content-container").remove()}else{a("#semplice").on("click",".content-container",n);a(u).find(".content-container").remove()}a(u).find("input[name=background-image]").each(function(){if(a(this).val()){a(this).next().show()}});if(a("input[name=img]").val()){a(u).find("img.image-preview").show()}a(u).find(".color-picker").wpColorPicker(q);a(u).find(".wp-picker-default").remove();if(s==="multi-column"){a(u).find(".save").attr("class","save-mc");a(u).find(".duplicate").attr("class","duplicate-mc");a(u).find(".save-block").attr("class","save-block-mc");a(u).find(".padding-left").first().remove();a(u).find(".padding-right").first().remove()}else{a(u).find(".padding-left, .padding-right").remove()}a(u).find(".fadein").transition({opacity:1},500,"ease",function(){a(this).removeClass("fadein")});a(u).addClass("in-edit-mode");a(".loader").fadeOut("slow");a(a.browser.webkit?"body":"html").animate({scrollTop:a(u).offset().top-100},0)}});t.fail(function(w,x){alert("Request failed: "+x);if(s!=="multi-column"){a("#semplice").on("click",".content-container",n)}a(".loader").fadeOut("slow")})},singleEdit:function(s,y){a(".loader").show();var x="#"+a(s).data("content-id");var u=a(y).data("single-edit-column-id");var v=a(y).data("single-edit-content-id");var w="#"+a(y).data("single-edit-content-id");var r=a(y).data("single-edit-content-type");var t=a.ajax({url:ajaxurl,type:"POST",data:{action:"semplice_ce_ajax",edit_mode:"single-edit",id:v,ccId:x,column_id:u,content_type:r,rom:f[x].columns[u][w]},dataType:"html"});t.done(function(z){a(x).append(z);a(x).find(".mc-content-container").remove();a(x).find("input[name=background-image]").each(function(){if(a(this).val()){a(this).next().show()}});if(a("input[name=img]").val()){a(x).find("img.image-preview").show()}a(x).find(".color-picker").wpColorPicker(q);a(x).find(".wp-picker-default").remove();a(w).find(".fadein").transition({opacity:1},500,"ease",function(){a(this).removeClass("fadein")});a(x).addClass("in-edit-mode");a(".loader").fadeOut("slow");a(a.browser.webkit?"body":"html").animate({scrollTop:a(x).offset().top-100},0)});t.fail(function(z,A){alert("Request failed: "+A);a(".loader").fadeOut("slow")})},duplicate:function(x){var s=a(x).data("content-id");var w="#"+a(x).data("content-id");var v=a(x).data("content-type");var t=l("content");var u="#"+t;f[u]=jQuery.extend(true,{},f[w]);a(w).clone().insertAfter(w).attr("id",t).html("");var r=a('<a data-content-id="'+t+'" data-content-type="'+v+'">');if(v!=="multi-column"){a("#semplice").off("click",".content-container")}k.edit(r)},remove:function(s){var r="#"+a(s).data("content-id");a(r).transition({opacity:0,marginTop:-40},400,"ease",function(){delete f[r];a(r).remove();if(!a.trim(a("#content-holder").html()).length){a(".semplice-ce-default").clone(true).appendTo("#semplice-content").stop().fadeIn(500)}})},removeColumn:function(t){var s="#"+a(t).data("content-id");var r=a(t).data("parent-id");a(s).transition({opacity:0,marginTop:-40},400,"ease",function(){if(f[r]!==undefined){delete f[r][s]}a(s).remove()})},up:function(v){var u="#"+a(v).data("content-id");var s=a(u).prev().attr("id");if(a(v).attr("class")==="column-up"){var t=a(u).attr("data-order");var r=a(u).prev().attr("data-order");if(r!==undefined){a(u).attr("data-order",r);a(u).find(".column-title").text("Column "+r);a("#"+s).attr("data-order",t);a("#"+s).find(".column-title").text("Column "+t)}}a(u).insertBefore("#"+s);a(a.browser.webkit?"body":"html").animate({scrollTop:a(u).offset().top-100},0)},down:function(v){var u="#"+a(v).data("content-id");var s=a(u).next().attr("id");if(a(v).attr("class")==="column-down"){var t=a(u).attr("data-order");var r=a(u).next().attr("data-order");if(r<=a(".column").length){a(u).attr("data-order",r);a(u).find(".column-title").text("Column "+r);a("#"+s).attr("data-order",t);a("#"+s).find(".column-title").text("Column "+t)}}a(u).insertAfter("#"+s);a(a.browser.webkit?"body":"html").animate({scrollTop:a(u).offset().top-100},0)},removeMedia:function(t,r){var s="#"+a(t).data("content-id");a(s).find(".is-"+r).first().val("");a(s).find("."+r+"-upload").first().text("Upload "+r);a(s).find("."+r+"-preview").first().attr("src","");a(s).find("."+r+"-preview").first().hide();if(r==="branding-bg-image"){a(s).find(".is-"+r).val("");a("#semplice-content").css("background-image","none");f.branding["background-image"]=""}},removeBg:function(s){var r="#"+a(s).data("content-id");a(r).find(".is-bg-image").val("");a(r).find(".bg-upload").text("Upload Image");a(r).find(".bg-preview").attr("src","");a(r).find(".bg-preview").hide()},customFontset:function(s){var r=a.ajax({url:ajaxurl,type:"POST",data:{action:"semplice_ce_ajax",edit_mode:"custom-fontset",fontset_id:s},dataType:"html"});r.done(function(t){if(!s){f.fontset="default"}else{f.fontset=s}a("[data-fontset-id=ce-fontset]").remove();a("style[id=ce-fontset]").remove();a("head").append(t);a(".loader").fadeOut("slow")});r.fail(function(t,u){alert("Request failed: "+u);a(".loader").fadeOut("slow")})},loadTemplate:function(s,r){a(".loader").show();a(".templates-sub").fadeOut(250,function(){var t=a.ajax({url:ajaxurl,type:"POST",data:{action:"semplice_ce_ajax",edit_mode:"load-template",template_id:s,template_type:r},dataType:"json"});t.done(function(u){a("#semplice-content").html(u.html);f=a.parseJSON(u.rom);if(f.branding===undefined){f.branding={}}if(f.modules===undefined){f.modules=[]}f.branding=a.parseJSON(u.branding);a("#semplice-content").css({"background-color":f.branding["background-color"],"background-image":"url("+f.branding["background-image"]+")","background-size":f.branding["background-size"],"background-position":f.branding["background-position"],"background-repeat":f.branding["background-repeat"]});a(".branding-bg-color").val(f.branding["background-color"]);a(".branding-sub .wp-color-result").css("backgroundColor",f.branding["background-color"]);var v=[f.branding["background-size"],f.branding["background-position"],f.branding["background-repeat"]];var x=0;a(".branding-sub .select-box").each(function(){var y=v[x];a(this).find("option").each(function(){if(a(this).val()===y){a(this).attr("selected","selected")}else{a(this).removeAttr("selected")}});x++});if(f.branding["background-image"]){a(".branding-bg-image-preview").attr("src",f.branding["background-image"]).show();a("input[name=branding-bg-image]").val(f.branding["background-image"])}if(f.fontset){var w=f.fontset;if(w!=="default"){a(".custom-fontset").find("option").each(function(){if(a(this).val()===w){a(this).attr("selected","selected")}else{a(this).removeAttr("selected")}});k.customFontset(w)}else{k.customFontset("default")}}a(".loader").fadeOut("slow")});t.fail(function(u,v){alert("Request failed: "+v);a(".loader").fadeOut("slow")});t.error(function(u){alert(u.responseText)})})},showLayers:function(t){a(".options-sub .show-layers").addClass("checked");var s=(t).data("content-id");a("#semplice").addClass("show-all-layers");a(".content-container, .mc-content-container").hide();a("#content-holder").sortable({axis:"y",cancel:".edit-content, .top-layer"});var r;a("#content-holder > div").each(function(){var x=false;var y="";var A="#"+a(this).attr("id");var u=a(this).attr("id");var w=a(this).children(".content-container, .mc-content-container").attr("data-content-type");var z="module-"+a(this).children(".content-container").attr("data-modules-array");if(!z){z=""}if(a(this).hasClass("in-edit-mode")){a(this).find(".edit-content").hide();a(this).addClass("layer-mode");x="edit";y="In edit mode";var v=a(this).find('input[name="layer-name"]').val()}else{var v=f[A].options["layer-name"]}if(s==u){a(this).append('<div class="layer"><div class="icon '+z+'"></div><p class="layer-name">'+v+'</p><a class="edit-layer" data-content-id="'+u+'" data-content-type="'+w+'" data-edit-mode="'+x+'"></a><a class="remove" data-content-id="'+u+'"></a><p class="in-edit-mode">'+y+'</p><div class="active-layer"></div><div class="drag-icon"></div>');r=A}else{a(this).append('<div class="layer"><div class="icon '+z+'"></div><p class="layer-name">'+v+'</p><a class="edit-layer" data-content-id="'+u+'" data-content-type="'+w+'" data-edit-mode="'+x+'"></a><a class="remove" data-content-id="'+u+'"></a><p class="in-edit-mode">'+y+'</p><div class="drag-icon"></div>')}a(this).children(".layer").stop().fadeIn(300)});a("#semplice-content").prepend('<div class="layer top-layer hide-layers" data-content-id="'+s+'"><div class="icon"></div><p class="layer-name">Back to edit mode</p></div>');a(".top-layer").fadeIn(300);if(r){a(a.browser.webkit?"body":"html").animate({scrollTop:a(r).offset().top-150},0)}a(t).addClass("checked")},hideLayers:function(v,r){a(".options-sub .show-layers").removeClass("checked");var u=a(v).data("content-id");var t=a(v).data("edit-mode");var s=a(v).data("content-type");a("#semplice").removeClass("show-all-layers");a(".content-container, .mc-content-container").show();a("#content-holder > div").each(function(){a(this).children(".layer").remove();if(a(this).hasClass("in-edit-mode")){a(this).find(".edit-content").show();a(this).removeClass("layer-mode")}});a(".top-layer").remove();a("#content-holder").sortable("destroy");if(r&&t!=="edit"){if(s!=="multi-column"){a("#semplice").off("click",".content-container")}k.edit(v)}else{if(u!=="undefined"){a(a.browser.webkit?"body":"html").animate({scrollTop:a("#"+u).offset().top-100},0)}}},saveBlock:function(v){var u="#"+a(v).data("content-id");var r=a(v).data("content-type");var t=a(u).html();var s=a.ajax({url:ajaxurl,type:"POST",data:{action:"semplice_ce_ajax",edit_mode:"save-block",id:u,rom:f[u],block_html:t,content_type:r},dataType:"html"});s.done(function(w){alert(w)});s.fail(function(w,x){alert("Request failed: "+x);a(".loader").fadeOut("slow")})},saveToWp:function(){a(".loader").show();if(a("#semplice-content").find(a(".semplice-ce-default")).is(":visible")){a("#semplice-content").find(a(".semplice-ce-default")).remove()}a("head").find("[data-fontset-id=ce-fontset]").each(function(){a(this).remove()});a("#ce-fontset").remove();a(".is-shortcode").each(function(){a(this).find(".executed").html(a(this).find(".unexecuted").html().replace("unex_",""))});a(".oembed-content, .code-content").each(function(){var B=a(this).html().replace("unex_","");a(this).html(B)});var y=a("#semplice-content").html();a(".semplice-content").val(y);f.branding={"background-color":a(".branding-bg-color").val(),"background-image":a(".branding-bg-image").val(),"background-size":a(".branding-bg-size").val(),"background-position":a(".branding-bg-pos").val(),"background-repeat":a(".branding-bg-repeat").val(),"background-attachment":a(".branding-bg-attachment").val()};if(f.fontset.length===0){f.fontset="default"}a(".fontset").val(f.fontset);a(".rom").val(JSON.stringify(f));var r=a(".content-p").length;var v=a(".content-img").length;var s=a(".content-video").length;var t=a(".mc-sub-content-container").length;var A=a(".content-gallery").length;var u=a(".content-audio").length;var z=a(".content-spacer").length;var x=a(".content-thumbnails").length;var w='<span class="comment">// Content stats</span><br /><br /><span class="num">'+r+'</span> paragraph(s), <span class="num">'+v+'</span> image(s)<br /><span class="num">'+s+'</span> video(s), <span class="num">'+t+'</span> column content(s)<br /><span class="num">'+A+'</span> gallery(s), <span class="num">'+u+'</span> audio file(s)<br /><span class="num">'+z+'</span> spacer(s), <span class="num">'+x+"</span> thumbview";a(".branding").val(JSON.stringify(f.branding));a("[data-modules-array]").each(function(){f.modules.push(a(this).data("modules-array"))});a(".modules").val(JSON.stringify(f.modules));a(".stats").val(w);a(".content-code").html(w);h=true;a("#wpwrap").show();a(".wp-pointer").show();a("#semplice").fadeOut(300)}};a(document).on("click",".add-semplice-editor",function(){if(!h){a("#semplice").appendTo("body");a(a.browser.webkit?"body":"html").animate({scrollTop:0},0,function(){a("#semplice").fadeIn(300,function(){a("#wpwrap").hide();a(".wp-pointer").hide();k.init()})})}else{alert("Please update or save your page / project before reopen the content editor!")}});a("#semplice").on("click",".add-content",function(){if(!a("#semplice").hasClass("show-all-layers")){k.add(a(this))}else{alert("Please exit the layer mode to add new content")}});a("#semplice").on("click",".add-column-content",function(){k.addColumnContent(a(this))});function g(){a("#semplice").off("click",".add-column");k.addColumn(a(this))}a("#semplice").on("click",".add-column",g);function p(r){a("#semplice").off("click",".save");a("#semplice").off("click",".duplicate");a("#semplice").off("click",".save-block");k.save(a(this),r.data.duplicate,r.data.save_block)}a("#semplice").on("click",".save",{duplicate:false,save_block:false},p);a("#semplice").on("click",".duplicate",{duplicate:true,save_block:false},p);a("#semplice").on("click",".save-block",{duplicate:false,save_block:true},p);function i(r){a("#semplice").off("click",".save-mc");a("#semplice").off("click",".duplicate-mc");a("#semplice").off("click",".save-block-mc");k.saveColumnContent(a(this),r.data.duplicate,r.data.save_block)}a("#semplice").on("click",".save-mc",{duplicate:false,save_block:false},i);a("#semplice").on("click",".duplicate-mc",{duplicate:true,save_block:false},i);a("#semplice").on("click",".save-block-mc",{duplicate:false,save_block:true},i);function d(){a("#semplice").off("click",".save-se");k.saveSingleEdit(a(this))}a("#semplice").on("click",".save-se",d);a("#semplice").on("click",".edit",function(){k.edit(a(this))});function n(){if(!a("#semplice").hasClass("show-all-layers")){a("#semplice").off("click",".content-container");k.edit(a(this))}else{k.hideLayers(a(this),true)}}a("#semplice").on("click",".content-container",n);a("#semplice").on("click",".edit-layer",n);a("#semplice").on("click",".video",function(r){r.stopPropagation()});a("#semplice").on("click",".mc-sub-content-container",function(r){var u=a(this);var t=a(this).offset().left,s=a(this).offset().top;a(this).children(".single-edit").css({top:(r.pageY-s),left:(r.pageX-t)}).show();a(this).find(".edit-column").unbind().click(function(){a(u).children(".single-edit").remove();k.edit(a(u))});a(this).find(".edit-single").unbind().click(function(){a(u).children(".single-edit").remove();k.singleEdit(a(u),a(this))})});a("#semplice").on("click","a.column-duplicate",function(){k.duplicateColumn(a(this))});a("#semplice").on("click",".remove",function(){a(".remove-confirm").data({"content-id":a(this).data("content-id"),"is-column":"","parent-id":""});a(".overlay").fadeIn(100);a(".confirm").fadeIn(100)});a("#semplice").on("click",".remove-column",function(){a(".remove-confirm").data({"content-id":a(this).data("column-id"),"is-column":"is-column","parent-id":a(this).data("parent-id")});a(".overlay").fadeIn(100);a(".confirm").fadeIn(100)});a("#semplice").on("click",".remove-confirm",function(){a(".overlay").fadeOut(100);a(".confirm").fadeOut(100);var r=a(this);if(a(this).data("is-column")==="is-column"){k.removeColumn(a(r))}else{k.remove(a(r))}});a("#semplice").on("click",".remove-decline",function(){a(".overlay").fadeOut(100);a(".confirm").fadeOut(100)});a("#semplice").on("click",".cancel-to-wp",function(){a(".overlay").fadeIn(100);a(".cancel").fadeIn(100)});a("#semplice").on("click",".cancel-confirm",function(){a(".overlay").fadeOut(100);a(".cancel").fadeOut(100,function(){a("#wpwrap").show();a("#semplice").fadeOut(300,function(){window.onbeforeunload=null})})});a("#semplice").on("click",".cancel-decline",function(){a(".overlay").fadeOut(100);a(".cancel").fadeOut(100)});a("#semplice").on("click",".show-layers",function(){if(!a("#semplice").hasClass("show-all-layers")){if(!a("#semplice-content").find(a(".semplice-ce-default")).is(":visible")){k.showLayers(a(this))}else{alert("To re-order your layers you have to add content first!")}}else{k.hideLayers(a(this))}});a("#semplice").on("click",".hide-layers",function(){k.hideLayers(a(this))});a("#semplice").on("click",".up",function(){k.up(a(this))});a("#semplice").on("click",".down",function(){k.down(a(this))});a("#semplice").on("click",".column-up",function(){k.up(a(this))});a("#semplice").on("click",".column-down",function(){k.down(a(this))});a("#semplice").on("click",".remove-media",function(){k.removeMedia(a(this),a(this).data("media"))});a("#semplice").on("click",".save-to-wp-activated",function(){if(a("#semplice-content").find(".in-edit-mode").length){alert("Please save or delete open edit fields.")}else{if(a("#semplice").hasClass("show-all-layers")){alert("Please exit the layer mode before save.")}else{k.saveToWp()}}});a("#semplice").on("change",".select-box",function(){var r=a(this).val();a(this).find("option").each(function(){if(a(this).val()===r){a(this).attr("selected","selected")}else{a(this).removeAttr("selected")}})});a("#semplice").on("change",".branding-bg-select",function(){var r=a(this).data("css-attribute");a("#semplice-content").css(r,a(this).val())});a("#semplice").on("change",".custom-fontset",function(){a(".loader").show();var r=a(this).val();a(this).find("option").each(function(){if(a(this).val()===r){a(this).attr("selected","selected")}else{a(this).removeAttr("selected")}});if(r!=="default"){k.customFontset(r)}else{k.customFontset("default")}});a("#semplice").on("click","a.background",function(){a(this).next(".background-sub").fadeIn(150)});a("#semplice").on("click","a.ce-dismiss",function(){a(".overlay").fadeOut(150);a(".no-images").fadeOut(250)});a("#semplice").on("change",".select-project, .select-page",function(){var r=a(this).val();if(r!=="default"){a(".loader").show();a(".template-confirm").data({"template-id":r,"template-type":"object"});a(".overlay").fadeIn(100);a(".confirm-template").fadeIn(100)}});a("#semplice").on("click","a.load-template",function(){a(".template-confirm").data({"template-id":a(this).data("template-id"),"template-type":"semplice"});a(".overlay").fadeIn(100);a(".confirm-template").fadeIn(100)});a("#semplice").on("click",".template-confirm",function(){a(".overlay").fadeOut(100);a(".confirm-template").fadeOut(100);k.loadTemplate(a(this).data("template-id"),a(this).data("template-type"))});a("#semplice").on("click",".template-decline",function(){a(".loader").hide();a(".overlay").fadeOut(100);a(".confirm-template").fadeOut(100)});a("#semplice").on("click","a.branding",function(){a(".branding-sub").fadeIn(150)});a("#semplice").on("click","a.show-templates",function(){a(".templates-sub").fadeIn(150)});a("#semplice").on("click","a.show-options",function(){a(".options-sub").fadeIn(150)});a("#semplice").on("click","a.show-modules",function(){if(a(this).data("in-column")){var r=a(this).data("column-id");a(".modules-sub-"+r).fadeIn(150)}else{a(".modules-sub-global").fadeIn(150)}});a("#semplice").on("click","a.padding",function(){a(this).next(".padding-sub").fadeIn(150)});a("#semplice").on("change","select[name=wysiwyg_bg_color]",function(){var r="#cke_"+a(this).data("content-id")+" .cke_wysiwyg_div";if(a(this).val()==="white"){a(r).css("backgroundColor","#ffffff")}else{a(r).css("backgroundColor","#000000")}});a("#semplice").on("click",".ce-help",function(){a(this).children("span").css("display","inline")});a("#semplice").mouseup(function(x){var z=a(".background-sub");var v=a(".media-modal-content");if(!z.is(x.target)&&!v.is(x.target)&&z.has(x.target).length===0){z.fadeOut(150)}var w=a(".branding-sub");if(!w.is(x.target)&&w.has(x.target).length===0){w.fadeOut(150)}var u=a(".options-sub");if(!u.is(x.target)&&u.has(x.target).length===0){u.fadeOut(150)}var y=a(".templates-sub");if(!y.is(x.target)&&y.has(x.target).length===0){y.fadeOut(250)}var r=a(".modules-sub");if(!r.is(x.target)&&r.has(x.target).length===0){r.fadeOut(250)}var A=a(".padding-sub");if(!A.is(x.target)&&A.has(x.target).length===0){A.fadeOut(150)}var s=a(".single-edit");if(!s.is(x.target)&&s.has(x.target).length===0){s.hide()}var t=a(".ce-help span");if(!t.is(x.target)&&t.has(x.target).length===0){t.css("display","none")}});a(".show-grid").toggle(function(){a("#grid").fadeIn("300");a(this).addClass("checked")},function(){a("#grid").fadeOut("300");a(this).removeClass("checked")});a("#semplice").on({mouseenter:function(){var r=a(this).find(".tooltip").width();r=(r-60)/2;a(this).find(".tooltip").css("marginLeft",-r);a(this).find(".tooltip").stop().fadeIn(120)},mouseleave:function(){a(this).find(".tooltip").stop().fadeOut(120)}},"ul.types li");a("#semplice").on({mouseenter:function(){var r=a(this).find(".tooltip").width();r=(r-50)/2;a(this).find(".tooltip").css("marginLeft",-r);a(this).find(".tooltip").stop().fadeIn(120)},mouseleave:function(){a(this).find(".tooltip").stop().fadeOut(120)}},"ul.atts-save li");function j(r){if(!r){return"transparent"}var t=r.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);function s(u){return("0"+parseInt(u).toString(16)).slice(-2)}if(t){return"#"+s(t[1])+s(t[2])+s(t[3])}else{return r}}function c(r){alert('The value for "'+r+'" contains invalid characters. Please avoid double quotes ("), single quotes (\') and backslashes (\\).')}var q={defaultColor:false,change:function(r,s){},hide:true,palettes:true};var b={defaultColor:false,change:function(r,s){a("#semplice-content").css("background-color",s.color.toString())},hide:true,palettes:true};var l=function(r){return r+"_"+Math.random().toString(36).substr(2,9)};function o(){a(window).scroll(function(){a.each(a(".sticky-mc-atts"),function(){var v=10;var u=a(this).height();var s=a(this).parent().offset().top;var r=a(this).parent().height();var t=a(window).scrollTop();if((s-v)<t&&t<(s-v+r-u)){if(!a(this).hasClass("is-sticky")){a(this).addClass("is-sticky");a(this).css("top",v+50);a(this).show()}}else{if(a(this).hasClass("is-sticky")){a(this).removeClass("is-sticky");a(this).css("top",s);a(this).hide()}}})})}})})(jQuery);